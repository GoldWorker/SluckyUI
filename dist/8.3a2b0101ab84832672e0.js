(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"50v7":function(e,t,r){e.exports={srcSet:r.p+"bf917aaa4865c92467515a63cde03f05-2244.png 2244w",images:[{path:r.p+"bf917aaa4865c92467515a63cde03f05-2244.png",width:2244,height:1399}],src:r.p+"bf917aaa4865c92467515a63cde03f05-2244.png",toString:function(){return r.p+"bf917aaa4865c92467515a63cde03f05-2244.png"},placeholder:void 0,width:2244,height:1399}},EBIn:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){__webpack_require__.d(__webpack_exports__,"default",function(){return ProtraitApp});var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("o0o1"),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("lwsE"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("W8MJ"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("a1gu"),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("Nsbk"),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("7W2i"),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__),react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("q1tI"),react__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__),slucky_src_component_toast__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("phJ6"),slucky_src_component_lrChange__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("jOWV"),enterModule;enterModule=__webpack_require__("0cfB").enterModule,enterModule&&enterModule(module);var CANVANS_SIZE=256,ProtraitApp=function(_Component){function ProtraitApp(){var e;_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this,ProtraitApp),e=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default()(ProtraitApp).call(this));var t=[{source:__webpack_require__("Wq8K"),style:{width:96,height:128,top:"".concat(CANVANS_SIZE-128),left:"".concat(CANVANS_SIZE-96)}},{source:__webpack_require__("Iwwu"),style:{width:96,height:128,top:0,left:80}},{source:__webpack_require__("50v7"),style:{width:256,height:256,top:0,left:0}}];return e.state={sourceImage:"",sourceImageUrl:"",imgUrl:"",targetUrl:"",decorationCurrent:t[0],decorationList:t},e}return _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(ProtraitApp,_Component),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default()(ProtraitApp,[{key:"componentDidMount",value:function(){this.initCanvas()}},{key:"initCanvas",value:function(){var e=this.refs.canvas;e.width=CANVANS_SIZE,e.height=CANVANS_SIZE}},{key:"handleChangeUpload",value:function(e){var t,r,_,a,n,o,i,c;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.async(function(u){for(;;)switch(u.prev=u.next){case 0:if(t=this.refs.canvas,r=t.getContext("2d"),_=e.target.files[0]){u.next=5;break}return u.abrupt("return",!1);case 5:if(/image/gi.test(_.type)){u.next=8;break}return slucky_src_component_toast__WEBPACK_IMPORTED_MODULE_7__.a.warn("仅支持上传图片"),u.abrupt("return",!1);case 8:return u.next=10,_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.awrap(this.file2Base64(_));case 10:return a=u.sent,u.next=13,_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.awrap(this.createImage(a));case 13:n=u.sent,(o=n.width-n.height)>0?(i=n.width*CANVANS_SIZE/n.height,r.drawImage(n,0,0,i,CANVANS_SIZE)):o<0?(c=n.height*CANVANS_SIZE/n.width,r.drawImage(n,0,0,CANVANS_SIZE,c)):r.drawImage(n,0,0,CANVANS_SIZE,CANVANS_SIZE),this.setState({imgUrl:t.toDataURL("image/png")});case 17:case"end":return u.stop()}},null,this)}},{key:"handleChangeDecorate",value:function(e){this.setState({decorationCurrent:e})}},{key:"handleClickSaveImage",value:function(){var e,t,r,_,a,n,o,i,c,u,l,s,p;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.async(function(h){for(;;)switch(h.prev=h.next){case 0:if(e=this.state,t=e.imgUrl,r=e.decorationCurrent,t){h.next=4;break}return slucky_src_component_toast__WEBPACK_IMPORTED_MODULE_7__.a.warn("请先上传头像"),h.abrupt("return",!1);case 4:return _=r.source,a=r.style,n=a.width,o=a.height,i=a.top,c=a.left,u=this.refs.canvas,this.clearCanvas(u),l=u.getContext("2d"),h.next=11,_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.awrap(this.createImage(t));case 11:return s=h.sent,l.drawImage(s,0,0,s.width,s.height),h.next=15,_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.awrap(this.createImage(_));case 15:p=h.sent,l.drawImage(p,c,i,n,o),this.downloadImage(u.toDataURL("image/png"));case 18:case"end":return h.stop()}},null,this)}},{key:"file2Base64",value:function(e){return new Promise(function(t,r){var _=new FileReader;_.readAsDataURL(e),_.onload=function(e){t(_.result)}})}},{key:"createImage",value:function(e){return new Promise(function(t,r){var _=new Image;_.src=e,_.onload=function(e){t(_)}})}},{key:"clearCanvas",value:function(e){e.getContext("2d").clearRect(0,0,e.width,e.height)}},{key:"downloadImage",value:function(e){if(e){var t=document.createElement("a");document.createEvent("HTMLEvents").initEvent("click",!0,!0),t.download="protrait.png",t.href=e,t.click()}}},{key:"num2px",value:function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var _=e[r];t[r]=_+"px"}return t}},{key:"render",value:function(){var e=this,t=this.state.decorationList,r=this.state.decorationCurrent,_=r.source,a=r.style;return react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"d-f ac fullscreen bg-title"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"w-full"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"fs18 ta-c pb32"},"制作你的专属头像"),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement(slucky_src_component_lrChange__WEBPACK_IMPORTED_MODULE_8__.a,{option:t,onChange:function(t){return e.handleChangeDecorate(t)}},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"p-r w256 h256 shadow"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("img",{src:_,alt:"",className:"p-a z1",style:this.num2px(a)}),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("img",{src:this.state.imgUrl,alt:"",className:"p-a l0 t0"}))),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"ta-c pt32"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"fileup-container mr8"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("div",{className:"fileup"},react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("label",{htmlFor:"input_file",className:"fileup-in btn ptb4 plr16 c-text-w bg-theme"},"上传头像"),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("input",{type:"file",id:"input_file",ref:"upload_file",onChange:function(t){return e.handleChangeUpload(t)}}))),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("button",{className:"btn btn-n plr16 ptb4 ml8",onClick:function(){return e.handleClickSaveImage()}},"保存头像")),react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("canvas",{className:"d-n",ref:"canvas"})))}},{key:"__reactstandin__regenerateByEval",value:function __reactstandin__regenerateByEval(key,code){this[key]=eval(code)}}]),ProtraitApp}(react__WEBPACK_IMPORTED_MODULE_6__.Component),reactHotLoader,leaveModule;reactHotLoader=__webpack_require__("0cfB").default,leaveModule=__webpack_require__("0cfB").leaveModule,reactHotLoader&&(reactHotLoader.register(CANVANS_SIZE,"CANVANS_SIZE","/Users/flyteng/Desktop/workspace/project/sluckyUI/src/pages/protraitApp.jsx"),reactHotLoader.register(ProtraitApp,"ProtraitApp","/Users/flyteng/Desktop/workspace/project/sluckyUI/src/pages/protraitApp.jsx"),leaveModule(module))}.call(this,__webpack_require__("3UD+")(module))},Iwwu:function(e,t,r){e.exports={srcSet:r.p+"64032bea6795aac2291bac19ec3c95b2-2000.png 2000w",images:[{path:r.p+"64032bea6795aac2291bac19ec3c95b2-2000.png",width:2e3,height:2e3}],src:r.p+"64032bea6795aac2291bac19ec3c95b2-2000.png",toString:function(){return r.p+"64032bea6795aac2291bac19ec3c95b2-2000.png"},placeholder:void 0,width:2e3,height:2e3}},Wq8K:function(e,t,r){e.exports={srcSet:r.p+"86c3b7f45c938aacad7abed6b504d896-2000.png 2000w",images:[{path:r.p+"86c3b7f45c938aacad7abed6b504d896-2000.png",width:2e3,height:2e3}],src:r.p+"86c3b7f45c938aacad7abed6b504d896-2000.png",toString:function(){return r.p+"86c3b7f45c938aacad7abed6b504d896-2000.png"},placeholder:void 0,width:2e3,height:2e3}},mLhc:function(e,t,r){var _=function(e){"use strict";var t,r=Object.prototype,_=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",i=a.toStringTag||"@@toStringTag";function c(e,t,r,_){var a=t&&t.prototype instanceof E?t:E,n=Object.create(a.prototype),o=new C(_||[]);return n._invoke=function(e,t,r){var _=l;return function(a,n){if(_===p)throw new Error("Generator is already running");if(_===h){if("throw"===a)throw n;return L()}for(r.method=a,r.arg=n;;){var o=r.delegate;if(o){var i=y(o,r);if(i){if(i===f)continue;return i}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(_===l)throw _=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);_=p;var c=u(e,t,r);if("normal"===c.type){if(_=r.done?h:s,c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(_=h,r.method="throw",r.arg=c.arg)}}}(e,r,o),n}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l="suspendedStart",s="suspendedYield",p="executing",h="completed",f={};function E(){}function d(){}function m(){}var g={};g[n]=function(){return this};var b=Object.getPrototypeOf,v=b&&b(b(A([])));v&&v!==r&&_.call(v,n)&&(g=v);var w=m.prototype=E.prototype=Object.create(g);function P(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function O(e){function t(r,a,n,o){var i=u(e[r],e,a);if("throw"!==i.type){var c=i.arg,l=c.value;return l&&"object"==typeof l&&_.call(l,"__await")?Promise.resolve(l.__await).then(function(e){t("next",e,n,o)},function(e){t("throw",e,n,o)}):Promise.resolve(l).then(function(e){c.value=e,n(c)},function(e){return t("throw",e,n,o)})}o(i.arg)}var r;this._invoke=function(e,_){function a(){return new Promise(function(r,a){t(e,_,r,a)})}return r=r?r.then(a,a):a()}}function y(e,r){var _=e.iterator[r.method];if(_===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,y(e,r),"throw"===r.method))return f;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var a=u(_,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,f;var n=a.arg;return n?n.done?(r[e.resultName]=n.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):n:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function A(e){if(e){var r=e[n];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function r(){for(;++a<e.length;)if(_.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:L}}function L(){return{value:t,done:!0}}return d.prototype=w.constructor=m,m.constructor=d,m[i]=d.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,i in e||(e[i]="GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},P(O.prototype),O.prototype[o]=function(){return this},e.AsyncIterator=O,e.async=function(t,r,_,a){var n=new O(c(t,r,_,a));return e.isGeneratorFunction(r)?n:n.next().then(function(e){return e.done?e.value:n.next()})},P(w),w[i]="Generator",w[n]=function(){return this},w.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var _=t.pop();if(_ in e)return r.value=_,r.done=!1,r}return r.done=!0,r}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&_.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function a(_,a){return i.type="throw",i.arg=e,r.next=_,a&&(r.method="next",r.arg=t),!!a}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],i=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var c=_.call(o,"catchLoc"),u=_.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&_.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var n=a;break}}n&&("break"===e||"continue"===e)&&n.tryLoc<=t&&t<=n.finallyLoc&&(n=null);var o=n?n.completion:{};return o.type=e,o.arg=t,n?(this.method="next",this.next=n.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),D(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var _=r.completion;if("throw"===_.type){var a=_.arg;D(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,_){return this.delegate={iterator:A(e),resultName:r,nextLoc:_},"next"===this.method&&(this.arg=t),f}},e}(e.exports);try{regeneratorRuntime=_}catch(e){Function("r","regeneratorRuntime = r")(_)}},o0o1:function(e,t,r){e.exports=r("mLhc")}}]);